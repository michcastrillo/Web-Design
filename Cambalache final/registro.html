<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro Cambalache</title>
    <link rel="stylesheet" href="style-index.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body>
    <header>
        <div class="b_inicio">
            <img id="logo" src="Images/logo.jpg" alt="">
            <nav id="nav_inicio">
                <ul>
                    <li><a href="index.html" rel="noopener">Inicio</a></li>
                    <li>|</li>
                    <li><a href="cambalaches.html" rel="noopener">Cambalaches</a></li>     
                    <li>|</li>        
                    <li><a href="login.html" rel="noopener">Ingresar</a></li>  
                    <li><button type="button">Mi carrito</button></li>
                </ul>      
            </nav>   
             <div class="topnav" onclick="myFunction()">
                    <button id="responsive_button" type="button">Menú</button>
                    <div id="myLinks"> 
                        <a href="index.html">Inicio</a>
                        <a href="cambalaches.html">Cambalaches</a>
                        <a href="login.html">Login</a>
                        <a href="">Mi carrito</a>
                    </div>
            </div>        
        </div>         
    </header> 
    <div class="container">
        <h1>Registro de usuario</h1>
        <p>--------------------------------------------</p>

            <input type="text" id="user_name_i" placeholder="First name" required>
            <input type="text" placeholder="Last name" id="last_name_i" required><br>
            <input class="i_address" type="text" id="address_1_i" placeholder="Address" required><br>
            <input class="i_address" type="text" id="address_2_i" placeholder="Address 2" required><br>
            <select id="country_select">
                <option>Country</option>
                <option>Argentina</option>
                <option>Bolivia</option>
                <option>Brasil</option>
                <option>Chile</option>
                <option>Colombia</option>
                <option>Costa Rica</option>
                <option>Cuba</option>
                <option>Ecuador</option>
                <option>El Salvador</option>
                <option>Guayana Francesa</option>
                <option>Granada</option>
                <option>Guatemala</option>
                <option>Guayana</option>
                <option>Haití</option>
                <option>Honduras</option>
                <option>Jamaica</option>
                <option>México</option>
                <option>Nicaragua</option>
                <option>Paraguay</option>
                <option>Panamá</option>
                <option>Perú</option>
                <option>Puerto Rico</option>
                <option>República Dominicana</option>
                <option>Surinam</option>
                <option>Uruguay</option>
                <option>Venezuela</option>
            </select>
            <input type="text" placeholder="City" id="city_i" required><br>
            <input type="email" name="user_email" placeholder="Correo Electrónico" id="email_i" required>
            <input type="password" placeholder="Contraseña" id="password_i" required>     
            <p>-------------------------------------------------------------------------------------------------</p>
            <p id="p_login">Si ya tiene una cuenta de usuario <a href="login.html" rel="noopener">ingrese aquí.</a></p>      
            <button id="b_buscador">Registrarse</button>
            <button type="reset">Cancelar</button>

    </div>
    <footer>
        <nav>
            <ul>
                <li><a href="index.html" rel="noopener">Inicio</a></li>
                <li>|</li>
                <li><a href="cambalaches.html" rel="noopener">Cambalaches</a></li>     
                <li>|</li>        
                <li><a href="login.html" rel="noopener">Ingresar</a></li>  
            </ul>      
        </nav> 
        <img id="cr" src="Images/copyright.png" alt="">
        <p>Cambalache.net</p> 
    </footer> 
    <script>
        function addUser(){
            const nombre = $('#user_name_i').val();
            const apellido = $('#last_name_i').val();
            const direccion = $('#address_1_i').val();            
            const direccion_2 = $('#address_2_i').val();

            const ciudad = $('#city_i').val();
            const correo = $('#email_i').val();
            const contrasena = $('#password_i').val();
            let paisSelect = $('#country_select option:selected').text();

            if(correo.indexOf("@")!=-1){
                let users_db = JSON.parse(localStorage.getItem('users'));
                if(!users_db) {
                    users_db = [];
                }
                const user = {
                    name: nombre,
                    last_name: apellido,
                    address: direccion,
                    address_2: direccion_2,
                    country: paisSelect,
                    city: ciudad,
                    email: correo,
                    password: contrasena,
                    id: users_db.length + 1
                }
                users_db.push(user);
                localStorage.setItem('users', JSON.stringify(users_db));
                console.log(JSON.parse(localStorage.getItem('users')));
                alert("Usted se ha registrado, inicie sesión")
                window.location.href = 'login.html';
            }else{
                alert('el email introducido no es válido')
            }
            
        }   
        function myFunction() {
            var x = document.getElementById("myLinks");
            if (x.style.display === "block") {
                x.style.display = "none";
            } else {
                x.style.display = "block";
            }
        }
        $('#b_buscador').click(function(){
            addUser();
            // $('#formId').attr('action', 'page2');
        });
    </script>
</body>
</html>